\chapter{はじめに}
時系列データの分析や予測は様々な分野で研究が進められてきた。
その中でも主に用いられてきたのは統計的手法と機械学習である。
統計的手法では古くからある隠れマルコフモデル\cite{hmm_original}を時系列データの予測に用いたもの\cite{hmm}や、自己回帰和分移動平均モデル\cite{arima}などが挙げられる。
機械学習ではニューラルネットワークを用いた研究が進められている。
近年、特に深層学習という多層に重ねたニューラルネットワークが時系列データを扱う様々なタスクで成果をあげている。
時系列データを扱うために初めて考えられたニューラルネットワークモデルはRNN\cite{rnn}である。
RNNはニューラルネットワークの中間層を再帰させているため中間層の数が大きくなり、勾配消失問題が発生した。
この問題に対処するために時系列データを扱う様々なニューラルネットワークが研究された。
その中でLSTM\cite{lstm_original}やESN\cite{esn}が高い精度を記録している。
LSTMはRNNにゲート機構をもたせることで必要な情報のみを伝播させることで勾配消失を防いだ。
ESNは中間層を再帰させるのではなく中間層をつなぎ替えることで時系列データを学習させた。
またLSTMは忘却ゲートの導入\cite{lstm_forget_gate}によって長期依存関係の考慮において高い精度を記録している。

しかし人間の脳における大脳皮質の学習は深層学習のように目的関数の誤差を減少させることで最適化を行っているのではないとされている\cite{neurons}。
人間の脳における学習はニューロンが発火していくことによるニューロン間をつなぐシナプスの発生によって行われる。
この学習を模したニューラルネットワークモデルとしてHierarchical Temporal Memory(HTM)が提案された。\cite{htm}

HTMの構造や学習アルゴリズムは人間の脳の大脳皮質を模したものとなっている。
HTMの構造は神経細胞を模したセルと名付けられたノードを2次元マップ状に配置したものとなっている。
またそのセルはそれぞれ非活性化状態、予測状態、活性化状態と遷移するようになっている。
学習アルゴリズムはそのセル間の繋がりであるシナプス接続の可否を変化させるというものである。
シナプス接続の可否は各シナプスの接続値を増減させることで変化させるが、それはヘブ則によって行われる。これはあるセルの発火の後に他のセルが発火した時にその２つのセル間のシナプス接続を強化させるというものである。

HTMはシナプス接続を元にして活性化状態のセルと繋がっているセルが予測状態に遷移し、次の時刻に置いて予測状態のセルが活性化状態に遷移することで時系列データを再現しようとする。
HTMはこのシナプス接続を束ねたものとしてセグメントという機構を持つが、これは神経細胞の樹状突起を模したものである。このセグメントは１つのセルに対して複数あるためセグメント集合となる。
HTMのように神経細胞の働きを模して時系列データの学習を行うモデルをスパイクニューロンモデル\cite{spike_neuron}という。
これは人間の脳の第一視覚野や聴覚野でも行われているとされている。\cite{brain_seq}

HTMの学習は深層学習でよく用いられるミニバッチ学習とは異なり、１つ１つのデータの入力に対して学習を更新するオンライン学習となっている。
また目的関数に対して最適化を行うのではないため教師なし学習に分類される。

他のHTMの特徴として疎な分散表現が挙げられる。マップ状になったセルの内わずかなセルのみが発火してデータを表現するため少ない計算量と幅広い表現力を持っている。

HTMは深層学習におけるニューラルネットワークに対して限られたタスクにおいては優位性があるが、ほとんどのタスクにおいて低い精度となっている。
また自然言語処理などの複雑なタスクには用いられていない。
特に長期依存考慮のための忘却ゲート機構を導入したLSTM\cite{lstm_forget_gate}のような高度な時系列予測が行えていない。

この原因としてHTMには長期依存考慮のための機構を備えていないことが考えられる。
特に疎な分散表現による学習が続けられていくに従って発火するセルが減少する。
これによって予測情報が維持できなくなり、長期依存関係が消失する。

そのため本研究ではHTMのセグメント集合に対して時間軸を導入し、複数前の時刻におけるデータを表現しているセルとの繋がりも学習可能なモデルを構築する。
これによって疎な分散表現を維持しつつも長期依存関係の学習を目指す。
人間の脳においてニューロンの発火は完全に同期的ではなく、ある時間ステップに基づいて発火している訳ではない。
そのためニューロンの発火時間のずれによってある一定の時間に発火したニューロン全てとのシナプス接続を学習すると考えられる。
本研究におけるHTMの改良はこのニューロンのシナプス接続の時間的に曖昧な部分を模したものになるとも言える。
またHTMの学習アルゴリズムを改良した研究というものは現在挙げられていない。
これを本研究の大きな貢献とする。

本研究の評価として様々な時系列データの予測タスクにおいて従来のHTMとの比較を行った。

以下、第２章でHTMの構造と学習アルゴリズムについて詳しく述べ、第３章で改良したHTMについて、第４章で評価実験、第５章で結論を述べる。
